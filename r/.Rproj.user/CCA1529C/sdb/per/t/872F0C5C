{
    "collab_server" : "",
    "contents" : "---\ntitle: \"project\"\nauthor: \"Zijian Han\"\ndate: \"December 12, 2017\"\noutput: html_document\n---\n\n\n```{r}\n# Load library\nsource(\"func.R\")\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(corrplot)\nlibrary(ROCR)\nlibrary(caret)\n```\n\n\n```{r}\n# Read data\ndf <- read.csv(\"dataset_22nov17.txt\",header=TRUE, sep=\"\", quote=\"\")\ndf <- df[,-1] ; colnames(df)[1] <- \"Sentence_num\"\n\n# In df, we have 4 variables for now, with 66161 tokens in 2999 sentences \n```\n\n###############################\n## Explanatory Data Analysis ##\n###############################\n```{r}\n# Let's get rid of the \"O\" class and take a look at the meaningful classes\ndf_sub <- df[-which(df$Tag == \"O\"),]\n\ndf_plot1 <- df_sub %>% group_by(Tag) %>%summarise(Tag_count=n())\n\nggplot(df_plot1, aes(reorder(Tag, Tag_count),Tag_count)) + geom_bar(stat = \"identity\",fill = \"indianred3\",alpha = 0.8) + theme_minimal() +xlab(\"Tag-class\") +\nylab(\"Number of Tags\")+theme(legend.position = c(0.95, 0.5), \nlegend.text = element_text(size = 15), \nlegend.title = element_text(size = 15),\naxis.title.x = element_text(size = 15),\naxis.title.y = element_text(size = 15),axis.text.x = element_text(size = 15,angle = 45),axis.text.y = element_text(size = 15))+coord_flip() + ggtitle(\"Frequency of Tags\")\n# Classes are really imbalance in our dataset\n# This could be harmful for XGBoost classifier.\n\ndf_plot2 <- df_sub %>% group_by(POS) %>%summarise(POS_count=n())\ndf_plot2 <- df_plot2[-which(df_plot2$POS_count<100),]\n\nggplot(df_plot2, aes(reorder(POS, POS_count),POS_count)) + geom_bar(stat = \"identity\",fill = \"orange3\",alpha = 0.8) + theme_minimal() +xlab(\"POS-class\") +\nylab(\"Number of POSs\")+theme(legend.position = c(0.95, 0.5), \nlegend.text = element_text(size = 15), \nlegend.title = element_text(size = 15),\naxis.title.x = element_text(size = 15),\naxis.title.y = element_text(size = 15),axis.text.x = element_text(size = 15,angle = 45),axis.text.y = element_text(size = 15))+coord_flip() + ggtitle(\"Frequency of POSs (Top 7 POS)\")\n\nggplot(df_sub,aes(Tag,Sentence_num))+geom_boxplot( fill=\"steelblue\") + theme_minimal() +xlab(\"Tag-class\") +\nylab(\"Sentence number\") +\ntheme(legend.position = c(0.95, 0.5), \nlegend.text = element_text(size = 15), \nlegend.title = element_text(size = 15),\naxis.title.x = element_text(size = 15),\naxis.title.y = element_text(size = 15),axis.text.x = element_text(size = 15,angle = 45),axis.text.y = element_text(size = 15)) + ggtitle(\"Sentence position of Tags\")\n# Looks like the sentence number have some effects on the Tag, but not much\n\ndf_plot3 <- df_sub %>% group_by(Tag,POS) %>%summarise(Tag_count=n())\ndf_plot3 <- df_plot3[which(df_plot3$POS == \"CD\"|df_plot3$POS == \"IN\"|df_plot3$POS == \"JJ\"|df_plot3$POS == \"NN\"|df_plot3$POS == \"NNP\"|df_plot3$POS == \"NNPS\"|df_plot3$POS == \"NNS\"),]\n\nggplot(df_plot3, aes(Tag, Tag_count,fill = POS)) + geom_bar(stat = \"identity\",position = \"fill\")+scale_fill_brewer(palette = \"Set1\")+ theme_minimal() +xlab(\"Tag-class\") +\nylab(\"Frequency of POS\") +\ntheme(legend.text = element_text(size = 15), \nlegend.title = element_text(size = 15),\naxis.title.x = element_text(size = 15),\naxis.title.y = element_text(size = 15),axis.text.x = element_text(size = 15,angle = 45),axis.text.y = element_text(size = 15)) + ggtitle(\"Frequency of POS for Tags\")\n\n\n#write.csv(df,\"df\")\n\n```\n\n\n########################## MODEL EVALUATION #####################\n\n\n##################################\n## XGBoost using Original data  ##\n##################################\n\n```{r}\n# Load the pred probability from XGBoost model\nresult_df <- NULL\n\nB_art <- read.csv(\"./plain/pred_result_B-art.csv\")\nresult_df$B_art_p <- B_art$pred\nresult_df$B_art_cp <- B_art$pred_cal\n\nI_gpe <- read.csv(\"./plain/pred_result_I-gpe.csv\")\nresult_df$I_gpe_p <- I_gpe$pred\nresult_df$I_gpe_cp <- I_gpe$pred_cal\n\nI_nat <- read.csv(\"./plain/pred_result_I-nat.csv\")\nresult_df$I_nat_p <- I_nat$pred\nresult_df$I_nat_cp <- I_nat$pred_cal\n\nI_org <- read.csv(\"./plain/pred_result_I-org.csv\")\nresult_df$I_org_p <- I_org$pred\nresult_df$I_org_cp <- I_org$pred_cal\n\nI_art <- read.csv(\"./plain/pred_result_I-art.csv\")\nresult_df$I_art_p <- I_art$pred\nresult_df$I_art_cp <- I_art$pred_cal\n\nI_per <- read.csv(\"./plain/pred_result_I-per.csv\")\nresult_df$I_per_p <- I_per$pred\nresult_df$I_per_cp <- I_per$pred_cal\n\nI_geo <- read.csv(\"./plain/pred_result_I-geo.csv\")\nresult_df$I_geo_p <- I_geo$pred\nresult_df$I_geo_cp <- I_geo$pred_cal\n\nB_nat <- read.csv(\"./plain/pred_result_B-nat.csv\")\nresult_df$B_nat_p <- B_nat$pred\nresult_df$B_nat_cp <- B_nat$pred_cal\n\nB_geo <- read.csv(\"./plain/pred_result_B-geo.csv\")\nresult_df$B_geo_p <- B_geo$pred\nresult_df$B_geo_cp <- B_geo$pred_cal\n\nB_gpe <- read.csv(\"./plain/pred_result_B-gpe.csv\")\nresult_df$B_gpe_p <- B_gpe$pred\nresult_df$B_gpe_cp <- B_gpe$pred_cal\n\nB_eve <- read.csv(\"./plain/pred_result_B-eve.csv\")\nresult_df$B_eve_p <- B_eve$pred\nresult_df$B_eve_cp <- B_eve$pred_cal\n\nB_org <- read.csv(\"./plain/pred_result_B-org.csv\")\nresult_df$B_org_p <- B_org$pred\nresult_df$B_org_cp <- B_org$pred_cal\n\nB_per <- read.csv(\"./plain/pred_result_B-per.csv\")\nresult_df$B_per_p <- B_per$pred\nresult_df$B_per_cp <- B_per$pred_cal\n\nI_tim <- read.csv(\"./plain/pred_result_I-tim.csv\")\nresult_df$I_tim_p <- I_tim$pred\nresult_df$I_tim_cp <- I_tim$pred_cal\n\nB_tim <- read.csv(\"./plain/pred_result_B-tim.csv\")\nresult_df$B_tim_p <- B_tim$pred\nresult_df$B_tim_cp <- B_tim$pred_cal\n\nI_eve <- read.csv(\"./plain/pred_result_I-eve.csv\")\nresult_df$I_eve_p <- I_eve$pred\nresult_df$I_eve_cp <- I_eve$pred_cal\n\n\ndf_result <- as.data.frame(result_df)\ndf_result_p <- df_result[,seq(1,31,2)]\ndf_result_cp <- df_result[,seq(2,32,2)]\n\ntest_data <- read.csv(\"./plain/test_data.csv\")\n```\n\n\n## Draw Roc Curve\n```{r}\ncolnames(df_result_p)\nroc_xgb.data.B_art_p <- extract_evaluation(tagName = \"B-art\",colname = \"B_art_p\",test_data = test_data, result_data = df_result_p)\n\nroc_xgb.data.I_gpe_p <- extract_evaluation(tagName = \"I-gpe\",colname = \"I_gpe_p\",test_data = test_data, result_data = df_result_p)\n\nroc_xgb.data.I_nat_p <- extract_evaluation(tagName = \"I-nat\",colname = \"I_nat_p\",test_data = test_data, result_data = df_result_p)\n\nroc_xgb.data.I_org_p <- extract_evaluation(tagName = \"I-org\",colname = \"I_org_p\",test_data = test_data, result_data = df_result_p)\n\nroc_xgb.data.I_art_p <- extract_evaluation(tagName = \"I-art\",colname = \"I_art_p\",test_data = test_data, result_data = df_result_p)\n\nroc_xgb.data.I_per_p <- extract_evaluation(tagName = \"I-per\",colname = \"I_per_p\",test_data = test_data, result_data = df_result_p)\n\nroc_xgb.data.I_geo_p <- extract_evaluation(tagName = \"I-geo\",colname = \"I_geo_p\",test_data = test_data, result_data = df_result_p)\n\nroc_xgb.data.B_nat_p <- extract_evaluation(tagName = \"B-nat\",colname = \"B_nat_p\",test_data = test_data, result_data = df_result_p)\n\nroc_xgb.data.B_geo_p <- extract_evaluation(tagName = \"B-geo\",colname = \"B_geo_p\",test_data = test_data, result_data = df_result_p)\n\nroc_xgb.data.B_gpe_p <- extract_evaluation(tagName = \"B-gpe\",colname = \"B_gpe_p\",test_data = test_data, result_data = df_result_p)\n\nroc_xgb.data.B_eve_p <- extract_evaluation(tagName = \"B-eve\",colname = \"B_eve_p\",test_data = test_data, result_data = df_result_p)\n\nroc_xgb.data.B_org_p <- extract_evaluation(tagName = \"B-org\",colname = \"B_org_p\",test_data = test_data, result_data = df_result_p)\n\nroc_xgb.data.B_per_p <- extract_evaluation(tagName = \"B-per\",colname = \"B_per_p\",test_data = test_data, result_data = df_result_p)\n\nroc_xgb.data.I_tim_p <- extract_evaluation(tagName = \"I-tim\",colname = \"I_tim_p\",test_data = test_data, result_data = df_result_p)\n\nroc_xgb.data.B_tim_p <- extract_evaluation(tagName = \"B-tim\",colname = \"B_tim_p\",test_data = test_data, result_data = df_result_p)\n\nroc_xgb.data.I_eve_p <- extract_evaluation(tagName = \"I-eve\",colname = \"I_eve_p\",test_data = test_data, result_data = df_result_p)\n\ncols <- c(\"b-art\" = \"antiquewhite4\", \"b-eve\" = \"cadetblue4\", \"b-geo\" = \"aquamarine4\", \"b-gpe\" = \"chartreuse3\", \"b-nat\" = \"chocolate3\", \"b-org\" = \"cornflowerblue\", \"b-per\" = \"brown3\", \"b-tim\" = \"darkgoldenrod3\", \"i-art\" = \"darkseagreen3\", \"i-eve\" = \"goldenrod3\", \"i-geo\" = \"gray\", \"i-gpe\" = \"deeppink3\", \"i-nat\" = \"lightsalmon\", \"i-org\" = \"limegreen\", \"i-per\" = \"magenta\", \"i-tim\" = \"navyblue\")\n\n# Creat roc curve for each class\nproc <- ggplot() + \ngeom_line(data = roc_xgb.data.B_art_p, aes(x=fpr, y=tpr,colour = \"b-art\"),lwd = 1) + \ngeom_line(data = roc_xgb.data.B_eve_p, aes(x=fpr, y=tpr,colour = \"b-eve\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.B_geo_p, aes(x=fpr, y=tpr,colour = \"b-geo\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.B_gpe_p, aes(x=fpr, y=tpr,colour = \"b-gpe\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.B_nat_p, aes(x=fpr, y=tpr,colour = \"b-nat\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.B_org_p, aes(x=fpr, y=tpr,colour = \"b-org\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.B_per_p, aes(x=fpr, y=tpr,colour = \"b-per\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.B_tim_p, aes(x=fpr, y=tpr,colour = \"b-tim\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.I_art_p, aes(x=fpr, y=tpr,colour = \"i-art\"),lwd = 1) + \ngeom_line(data = roc_xgb.data.I_eve_p, aes(x=fpr, y=tpr,colour = \"i-eve\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.I_geo_p, aes(x=fpr, y=tpr,colour = \"i-geo\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.I_gpe_p, aes(x=fpr, y=tpr,colour = \"i-gpe\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.I_nat_p, aes(x=fpr, y=tpr,colour = \"i-nat\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.I_org_p, aes(x=fpr, y=tpr,colour = \"i-org\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.I_per_p, aes(x=fpr, y=tpr,colour = \"i-per\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.I_tim_p, aes(x=fpr, y=tpr,colour = \"i-tim\"),lwd = 1) +\ngeom_vline(xintercept = 0.5, color = \"red\", linetype=2) + theme_bw() + #set themes\nscale_colour_manual(name = \"Labels\", values = cols) + \nxlab(\"False Positive Rate\") +\nylab(\"True Positive Rate\") +\ntheme(legend.position = c(0.95, 0.5), \nlegend.text = element_text(size = 15), \nlegend.title = element_text(size = 15),\naxis.title.x = element_text(size = 15),\naxis.title.y = element_text(size = 15))\n\nproc\n```\n\n\n### Confusion matrix\n```{r}\ndraw_confusion_matrix(tagName = \"B-art\",colname = \"B_art_p\",test_data = test_data, result_data = df_result_p,thresh = 1,color = \"antiquewhite4\")\n\ndraw_confusion_matrix(tagName = \"I-gpe\",colname = \"I_gpe_p\",test_data = test_data, result_data = df_result_p,thresh = 1,color = \"deeppink3\")\n\ndraw_confusion_matrix(tagName = \"I-nat\",colname = \"I_nat_p\",test_data = test_data, result_data = df_result_p,thresh = 1,color = \"lightsalmon\")\n\ndraw_confusion_matrix(tagName = \"I-org\",colname = \"I_org_p\",test_data = test_data, result_data = df_result_p,thresh = 1,color = \"limegreen\")\n\ndraw_confusion_matrix(tagName = \"I-art\",colname = \"I_art_p\",test_data = test_data, result_data = df_result_p,thresh = 1,color = \"darkseagreen3\")\n\ndraw_confusion_matrix(tagName = \"I-per\",colname = \"I_per_p\",test_data = test_data, result_data = df_result_p,thresh = 1,color = \"magenta\")\n\n\ndraw_confusion_matrix(tagName = \"I-geo\",colname = \"I_geo_p\",test_data = test_data, result_data = df_result_p,thresh = 1,color = \"gray\")\n\ndraw_confusion_matrix(tagName = \"B-geo\",colname = \"B_geo_p\",test_data = test_data, result_data = df_result_p,thresh = 1,color = \"aquamarine4\")\n\ndraw_confusion_matrix(tagName = \"B-gpe\",colname = \"B_gpe_p\",test_data = test_data, result_data = df_result_p,thresh = 1,color = \"chartreuse3\")\n\ndraw_confusion_matrix(tagName = \"B-eve\",colname = \"B_eve_p\",test_data = test_data, result_data = df_result_p,thresh = 1,color = \"cadetblue4\")\n\ndraw_confusion_matrix(tagName = \"B-org\",colname = \"B_org_p\",test_data = test_data, result_data = df_result_p,thresh = 1,color = \"cornflowerblue\")\n\ndraw_confusion_matrix(tagName = \"B-per\",colname = \"B_per_p\",test_data = test_data, result_data = df_result_p,thresh = 1,color = \"brown3\")\n\ndraw_confusion_matrix(tagName = \"I-tim\",colname = \"I_tim_p\",test_data = test_data, result_data = df_result_p,thresh = 1,color = \"navyblue\")\n\ndraw_confusion_matrix(tagName = \"B-tim\",colname = \"B_tim_p\",test_data = test_data, result_data = df_result_p,thresh = 1.0,color = \"darkgoldenrod3\")\n\ndraw_confusion_matrix(tagName = \"I-eve\",colname = \"I_eve_p\",test_data = test_data, result_data = df_result_p,thresh = 1,color = \"goldenrod3\")\n\ndraw_confusion_matrix(tagName = \"B-nat\",colname = \"B_nat_p\",test_data = test_data, result_data = df_result_p,thresh = 1,color = \"chocolate3\")\n\n```\n\n# Draw Precision curve\n```{r}\nprec_xgb.data.B_art_p <- precision_curve(tagName = \"B-art\",colname = \"B_art_p\",test_data = test_data, result_data = df_result_p)\n\nprec_xgb.data.I_gpe_p <- precision_curve(tagName = \"I-gpe\",colname = \"I_gpe_p\",test_data = test_data, result_data = df_result_p)\n\nprec_xgb.data.I_nat_p <- precision_curve(tagName = \"I-nat\",colname = \"I_nat_p\",test_data = test_data, result_data = df_result_p)\n\nprec_xgb.data.I_org_p <- precision_curve(tagName = \"I-org\",colname = \"I_org_p\",test_data = test_data, result_data = df_result_p)\n\nprec_xgb.data.I_art_p <- precision_curve(tagName = \"I-art\",colname = \"I_art_p\",test_data = test_data, result_data = df_result_p)\n\nprec_xgb.data.I_per_p <- precision_curve(tagName = \"I-per\",colname = \"I_per_p\",test_data = test_data, result_data = df_result_p)\n\nprec_xgb.data.I_geo_p <- precision_curve(tagName = \"I-geo\",colname = \"I_geo_p\",test_data = test_data, result_data = df_result_p)\n\nprec_xgb.data.B_nat_p <- precision_curve(tagName = \"B-nat\",colname = \"B_nat_p\",test_data = test_data, result_data = df_result_p)\n\nprec_xgb.data.B_geo_p <- precision_curve(tagName = \"B-geo\",colname = \"B_geo_p\",test_data = test_data, result_data = df_result_p)\n\nprec_xgb.data.B_gpe_p <- precision_curve(tagName = \"B-gpe\",colname = \"B_gpe_p\",test_data = test_data, result_data = df_result_p)\n\nprec_xgb.data.B_eve_p <- precision_curve(tagName = \"B-eve\",colname = \"B_eve_p\",test_data = test_data, result_data = df_result_p)\n\nprec_xgb.data.B_org_p <- precision_curve(tagName = \"B-org\",colname = \"B_org_p\",test_data = test_data, result_data = df_result_p)\n\nprec_xgb.data.B_per_p <- precision_curve(tagName = \"B-per\",colname = \"B_per_p\",test_data = test_data, result_data = df_result_p)\n\nprec_xgb.data.I_tim_p <- precision_curve(tagName = \"I-tim\",colname = \"I_tim_p\",test_data = test_data, result_data = df_result_p)\n\nprec_xgb.data.B_tim_p <- precision_curve(tagName = \"B-tim\",colname = \"B_tim_p\",test_data = test_data, result_data = df_result_p)\n\nprec_xgb.data.I_eve_p <- precision_curve(tagName = \"I-eve\",colname = \"I_eve_p\",test_data = test_data, result_data = df_result_p)\n\nprec <- ggplot() + \ngeom_line(data = prec_xgb.data.B_art_p, aes(x=x, y=y,colour = \"b-art\"),lwd = 1) + \ngeom_line(data = prec_xgb.data.B_eve_p, aes(x=x, y=y,colour = \"b-eve\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.B_geo_p, aes(x=x, y=y,colour = \"b-geo\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.B_gpe_p, aes(x=x, y=y,colour = \"b-gpe\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.B_nat_p, aes(x=x, y=y,colour = \"b-nat\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.B_org_p, aes(x=x, y=y,colour = \"b-org\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.B_per_p, aes(x=x, y=y,colour = \"b-per\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.B_tim_p, aes(x=x, y=y,colour = \"b-tim\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.I_art_p, aes(x=x, y=y,colour = \"i-art\"),lwd = 1) + \ngeom_line(data = prec_xgb.data.I_eve_p, aes(x=x, y=y,colour = \"i-eve\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.I_geo_p, aes(x=x, y=y,colour = \"i-geo\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.I_gpe_p, aes(x=x, y=y,colour = \"i-gpe\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.I_nat_p, aes(x=x, y=y,colour = \"i-nat\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.I_org_p, aes(x=x, y=y,colour = \"i-org\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.I_per_p, aes(x=x, y=y,colour = \"i-per\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.I_tim_p, aes(x=x, y=y,colour = \"i-tim\"),lwd = 1) +\nxlab(\"Cutoff\") +\nylab(\"Precision\") +\ngeom_vline(xintercept = 0.5, color = \"red\", linetype=2) + theme_bw() +\ntheme(legend.position = c(0.95, 0.5), \nlegend.text = element_text(size = 15), \nlegend.title = element_text(size = 15),\naxis.title.x = element_text(size = 15),\naxis.title.y = element_text(size = 15))\n\nprec\n```\n\n\n## Draw Recall curve\n```{r}\nrec_xgb.data.B_art_p <- recall_curve(tagName = \"B-art\",colname = \"B_art_p\",test_data = test_data, result_data = df_result_p)\n\nrec_xgb.data.I_gpe_p <- recall_curve(tagName = \"I-gpe\",colname = \"I_gpe_p\",test_data = test_data, result_data = df_result_p)\n\nrec_xgb.data.I_nat_p <- recall_curve(tagName = \"I-nat\",colname = \"I_nat_p\",test_data = test_data, result_data = df_result_p)\n\nrec_xgb.data.I_org_p <- recall_curve(tagName = \"I-org\",colname = \"I_org_p\",test_data = test_data, result_data = df_result_p)\n\nrec_xgb.data.I_art_p <- recall_curve(tagName = \"I-art\",colname = \"I_art_p\",test_data = test_data, result_data = df_result_p)\n\nrec_xgb.data.I_per_p <- recall_curve(tagName = \"I-per\",colname = \"I_per_p\",test_data = test_data, result_data = df_result_p)\n\nrec_xgb.data.I_geo_p <- recall_curve(tagName = \"I-geo\",colname = \"I_geo_p\",test_data = test_data, result_data = df_result_p)\n\nrec_xgb.data.B_nat_p <- recall_curve(tagName = \"B-nat\",colname = \"B_nat_p\",test_data = test_data, result_data = df_result_p)\n\nrec_xgb.data.B_geo_p <- recall_curve(tagName = \"B-geo\",colname = \"B_geo_p\",test_data = test_data, result_data = df_result_p)\n\nrec_xgb.data.B_gpe_p <- recall_curve(tagName = \"B-gpe\",colname = \"B_gpe_p\",test_data = test_data, result_data = df_result_p)\n\nrec_xgb.data.B_eve_p <- recall_curve(tagName = \"B-eve\",colname = \"B_eve_p\",test_data = test_data, result_data = df_result_p)\n\nrec_xgb.data.B_org_p <- recall_curve(tagName = \"B-org\",colname = \"B_org_p\",test_data = test_data, result_data = df_result_p)\n\nrec_xgb.data.B_per_p <- recall_curve(tagName = \"B-per\",colname = \"B_per_p\",test_data = test_data, result_data = df_result_p)\n\nrec_xgb.data.I_tim_p <- recall_curve(tagName = \"I-tim\",colname = \"I_tim_p\",test_data = test_data, result_data = df_result_p)\n\nrec_xgb.data.B_tim_p <- recall_curve(tagName = \"B-tim\",colname = \"B_tim_p\",test_data = test_data, result_data = df_result_p)\n\nrec_xgb.data.I_eve_p <- recall_curve(tagName = \"I-eve\",colname = \"I_eve_p\",test_data = test_data, result_data = df_result_p)\n\nrec <- ggplot() + \ngeom_line(data = rec_xgb.data.B_art_p, aes(x=x, y=y,colour = \"b-art\"),lwd = 1) + \ngeom_line(data = rec_xgb.data.B_eve_p, aes(x=x, y=y,colour = \"b-eve\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.B_geo_p, aes(x=x, y=y,colour = \"b-geo\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.B_gpe_p, aes(x=x, y=y,colour = \"b-gpe\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.B_nat_p, aes(x=x, y=y,colour = \"b-nat\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.B_org_p, aes(x=x, y=y,colour = \"b-org\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.B_per_p, aes(x=x, y=y,colour = \"b-per\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.B_tim_p, aes(x=x, y=y,colour = \"b-tim\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.I_art_p, aes(x=x, y=y,colour = \"i-art\"),lwd = 1) + \ngeom_line(data = rec_xgb.data.I_eve_p, aes(x=x, y=y,colour = \"i-eve\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.I_geo_p, aes(x=x, y=y,colour = \"i-geo\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.I_gpe_p, aes(x=x, y=y,colour = \"i-gpe\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.I_nat_p, aes(x=x, y=y,colour = \"i-nat\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.I_org_p, aes(x=x, y=y,colour = \"i-org\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.I_per_p, aes(x=x, y=y,colour = \"i-per\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.I_tim_p, aes(x=x, y=y,colour = \"i-tim\"),lwd = 1) +\nxlab(\"Cutoff\") +\nylab(\"Recall\") +\ngeom_vline(xintercept = 0.5, color = \"red\", linetype=2) + theme_bw() +\ntheme(legend.position = c(0.95, 0.5), \nlegend.text = element_text(size = 15), \nlegend.title = element_text(size = 15),\naxis.title.x = element_text(size = 15),\naxis.title.y = element_text(size = 15))\n\nrec\n```\n\n\n####################\n## Combined data  ##\n####################\n\n## Creat Combine Data\n```{r}\ndf <- read.csv(\"df_features.csv\")\n\nart_idx <- which(df$Tag == \"B-art\"|df$Tag == \"I-art\")\neve_idx <- which(df$Tag == \"B-eve\"|df$Tag == \"I-eve\")\ngeo_idx <- which(df$Tag == \"B-geo\"|df$Tag == \"I-geo\")\ngpe_idx <- which(df$Tag == \"B-gpe\"|df$Tag == \"I-gpe\")\nnat_idx <- which(df$Tag == \"B-nat\"|df$Tag == \"I-nat\")\norg_idx <- which(df$Tag == \"B-org\"|df$Tag == \"I-org\")\nper_idx <- which(df$Tag == \"B-per\"|df$Tag == \"I-per\")\ntim_idx <- which(df$Tag == \"B-tim\"|df$Tag == \"I-tim\")\n\ndf_combine <- df\ndf_combine$Tag <- as.character(df_combine$Tag)\ndf_combine$Tag[art_idx] <- \"Art\"\ndf_combine$Tag[eve_idx] <- \"Eve\"\ndf_combine$Tag[geo_idx] <- \"Geo\"\ndf_combine$Tag[gpe_idx] <- \"Gpe\"\ndf_combine$Tag[nat_idx] <- \"Nat\"\ndf_combine$Tag[org_idx] <- \"Org\"\ndf_combine$Tag[per_idx] <- \"Per\"\ndf_combine$Tag[tim_idx] <- \"Tim\"\ndf_combine$Tag <- as.factor(df_combine$Tag)\ntable(df_combine$Tag)\n#write.csv(df_combine,\"df_combine.csv\")\n\n```\n\n## Read Binary Classfication result from combined sample\n```{r}\nresult_df <- NULL\n\nart <- read.csv(\"./combined/pred_result_Art.csv\")\nresult_df$art_p <- art$pred\n\ngpe <- read.csv(\"./combined/pred_result_Gpe.csv\")\nresult_df$gpe_p <- gpe$pred\n\nnat <- read.csv(\"./combined/pred_result_Nat.csv\")\nresult_df$nat_p <- nat$pred\n\norg <- read.csv(\"./combined/pred_result_Org.csv\")\nresult_df$org_p <- org$pred\n\nper <- read.csv(\"./combined/pred_result_Per.csv\")\nresult_df$per_p <- per$pred\n\ngeo <- read.csv(\"./combined/pred_result_Geo.csv\")\nresult_df$geo_p <- geo$pred\n\neve <- read.csv(\"./combined/pred_result_Eve.csv\")\nresult_df$eve_p <- eve$pred\n\ntim <- read.csv(\"./combined/pred_result_Tim.csv\")\nresult_df$tim_p <- tim$pred\n\n\ndf_result <- as.data.frame(result_df)\ndf_result_p <- df_result\n\ntest_data <- read.csv(\"./combined/df_com_test.csv\")\n```\n\n## Draw Roc curve\n```{r}\nroc_xgb.data.art_p <- extract_evaluation(tagName = \"Art\",colname = \"art_p\",test_data = test_data, result_data = df_result_p)\n\nroc_xgb.data.gpe_p <- extract_evaluation(tagName = \"Gpe\",colname = \"gpe_p\",test_data = test_data, result_data = df_result_p)\n\nroc_xgb.data.nat_p <- extract_evaluation(tagName = \"Nat\",colname = \"nat_p\",test_data = test_data, result_data = df_result_p)\n\nroc_xgb.data.org_p <- extract_evaluation(tagName = \"Org\",colname = \"org_p\",test_data = test_data, result_data = df_result_p)\n\nroc_xgb.data.per_p <- extract_evaluation(tagName = \"Per\",colname = \"per_p\",test_data = test_data, result_data = df_result_p)\n\nroc_xgb.data.geo_p <- extract_evaluation(tagName = \"Geo\",colname = \"geo_p\",test_data = test_data, result_data = df_result_p)\n\nroc_xgb.data.eve_p <- extract_evaluation(tagName = \"Eve\",colname = \"eve_p\",test_data = test_data, result_data = df_result_p)\n\nroc_xgb.data.tim_p <- extract_evaluation(tagName = \"Tim\",colname = \"tim_p\",test_data = test_data, result_data = df_result_p)\n\n\ncols <- c(\"Art\" = \"antiquewhite4\", \"Eve\" = \"cadetblue4\", \"Geo\" = \"aquamarine4\", \"Gpe\" = \"chartreuse3\", \"Nat\" = \"chocolate3\", \"Org\" = \"cornflowerblue\", \"Per\" = \"brown3\", \"Tim\" = \"darkgoldenrod3\")\n\n# Creat roc curve for each class\nproc <- ggplot() + \ngeom_line(data = roc_xgb.data.art_p, aes(x=fpr, y=tpr,colour = \"Art\"),lwd = 1) + \ngeom_line(data = roc_xgb.data.eve_p, aes(x=fpr, y=tpr,colour = \"Eve\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.geo_p, aes(x=fpr, y=tpr,colour = \"Geo\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.gpe_p, aes(x=fpr, y=tpr,colour = \"Gpe\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.nat_p, aes(x=fpr, y=tpr,colour = \"Nat\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.org_p, aes(x=fpr, y=tpr,colour = \"Org\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.per_p, aes(x=fpr, y=tpr,colour = \"Per\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.tim_p, aes(x=fpr, y=tpr,colour = \"Tim\"),lwd = 1) +\ngeom_vline(xintercept = 0.5, color = \"red\", linetype=2) + theme_bw() + #set themes\nscale_colour_manual(name = \"Labels\", values = cols) + \nxlab(\"False Positive Rate\") +\nylab(\"True Positive Rate\") +\ntheme(legend.text = element_text(size = 15), \nlegend.title = element_text(size = 15),\naxis.title.x = element_text(size = 15),\naxis.title.y = element_text(size = 15))\n\nproc\n\n```\n\n## Draw Confusion Matrix\n```{r}\ndraw_confusion_matrix(tagName = \"Art\",colname = \"art_p\",test_data = test_data, result_data = df_result_p,thresh = 1,color = \"antiquewhite4\")\n\ndraw_confusion_matrix(tagName = \"Gpe\",colname = \"gpe_p\",test_data = test_data, result_data = df_result_p,thresh = 1,color = \"chartreuse3\")\n\ndraw_confusion_matrix(tagName = \"Nat\",colname = \"nat_p\",test_data = test_data, result_data = df_result_p,thresh = 1,color = \"chocolate3\")\n\ndraw_confusion_matrix(tagName = \"Org\",colname = \"org_p\",test_data = test_data, result_data = df_result_p,thresh = 1,color = \"cornflowerblue\")\n\ndraw_confusion_matrix(tagName = \"Per\",colname = \"per_p\",test_data = test_data, result_data = df_result_p,thresh = 1,color = \"brown3\")\n\ndraw_confusion_matrix(tagName = \"Geo\",colname = \"geo_p\",test_data = test_data, result_data = df_result_p,thresh = 1,color = \"aquamarine4\")\n\ndraw_confusion_matrix(tagName = \"Eve\",colname = \"eve_p\",test_data = test_data, result_data = df_result_p,thresh = 1,color = \"cadetblue4\")\n\ndraw_confusion_matrix(tagName = \"Tim\",colname = \"tim_p\",test_data = test_data, result_data = df_result_p,thresh = 1,color = \"darkgoldenrod3\")\n```\n\n## Draw Precision Curve\n```{r}\nprec_xgb.data.art_p <- precision_curve(tagName = \"Art\",colname = \"art_p\",test_data = test_data, result_data = df_result_p)\n\nprec_xgb.data.gpe_p <- precision_curve(tagName = \"Gpe\",colname = \"gpe_p\",test_data = test_data, result_data = df_result_p)\n\nprec_xgb.data.nat_p <- precision_curve(tagName = \"Nat\",colname = \"nat_p\",test_data = test_data, result_data = df_result_p)\n\nprec_xgb.data.org_p <- precision_curve(tagName = \"Org\",colname = \"org_p\",test_data = test_data, result_data = df_result_p)\n\nprec_xgb.data.per_p <- precision_curve(tagName = \"Per\",colname = \"per_p\",test_data = test_data, result_data = df_result_p)\n\nprec_xgb.data.geo_p <- precision_curve(tagName = \"Geo\",colname = \"geo_p\",test_data = test_data, result_data = df_result_p)\n\nprec_xgb.data.eve_p <- precision_curve(tagName = \"Eve\",colname = \"eve_p\",test_data = test_data, result_data = df_result_p)\n\nprec_xgb.data.tim_p <- precision_curve(tagName = \"Tim\",colname = \"tim_p\",test_data = test_data, result_data = df_result_p)\n\nprec <- ggplot() + \ngeom_line(data = prec_xgb.data.art_p, aes(x=x, y=y,colour = \"Art\"),lwd = 1) + \ngeom_line(data = prec_xgb.data.eve_p, aes(x=x, y=y,colour = \"Eve\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.geo_p, aes(x=x, y=y,colour = \"Geo\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.gpe_p, aes(x=x, y=y,colour = \"Gpe\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.nat_p, aes(x=x, y=y,colour = \"Nat\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.org_p, aes(x=x, y=y,colour = \"Org\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.per_p, aes(x=x, y=y,colour = \"Per\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.tim_p, aes(x=x, y=y,colour = \"Tim\"),lwd = 1)+\nxlab(\"Cutoff\") +\nylab(\"Precision\") +\ngeom_vline(xintercept = 0.5, color = \"red\", linetype=2) + theme_bw() +\ntheme(legend.text = element_text(size = 15), \nlegend.title = element_text(size = 15),\naxis.title.x = element_text(size = 15),\naxis.title.y = element_text(size = 15))\n\nprec\n```\n\n## Draw Recall Curve\n```{r}\nrec_xgb.data.art_p <- recall_curve(tagName = \"Art\",colname = \"art_p\",test_data = test_data, result_data = df_result_p)\n\nrec_xgb.data.gpe_p <- recall_curve(tagName = \"Gpe\",colname = \"gpe_p\",test_data = test_data, result_data = df_result_p)\n\nrec_xgb.data.nat_p <- recall_curve(tagName = \"Nat\",colname = \"nat_p\",test_data = test_data, result_data = df_result_p)\n\nrec_xgb.data.org_p <- recall_curve(tagName = \"Org\",colname = \"org_p\",test_data = test_data, result_data = df_result_p)\n\nrec_xgb.data.per_p <- recall_curve(tagName = \"Per\",colname = \"per_p\",test_data = test_data, result_data = df_result_p)\n\nrec_xgb.data.geo_p <- recall_curve(tagName = \"Geo\",colname = \"geo_p\",test_data = test_data, result_data = df_result_p)\n\nrec_xgb.data.eve_p <- recall_curve(tagName = \"Eve\",colname = \"eve_p\",test_data = test_data, result_data = df_result_p)\n\nrec_xgb.data.tim_p <- recall_curve(tagName = \"Tim\",colname = \"tim_p\",test_data = test_data, result_data = df_result_p)\n\nrec <- ggplot() + \ngeom_line(data = rec_xgb.data.art_p, aes(x=x, y=y,colour = \"Art\"),lwd = 1) + \ngeom_line(data = rec_xgb.data.eve_p, aes(x=x, y=y,colour = \"Eve\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.geo_p, aes(x=x, y=y,colour = \"Geo\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.gpe_p, aes(x=x, y=y,colour = \"Gpe\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.nat_p, aes(x=x, y=y,colour = \"Nat\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.org_p, aes(x=x, y=y,colour = \"Org\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.per_p, aes(x=x, y=y,colour = \"Per\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.tim_p, aes(x=x, y=y,colour = \"Tim\"),lwd = 1) +\nxlab(\"Cutoff\") +\nylab(\"Recall\") +\ngeom_vline(xintercept = 0.5, color = \"red\", linetype=2) + theme_bw() +\ntheme(legend.text = element_text(size = 15), \nlegend.title = element_text(size = 15),\naxis.title.x = element_text(size = 15),\naxis.title.y = element_text(size = 15))\n\nrec\n```\n\n\n\n###############################\n## Balance data using SMOTE  ##\n###############################\n\n## Read Binary Classification result from SMOTE sample\n```{r}\nresult_df <- NULL\n\nB_art <- read.csv(\"./balance_model/pred_result_B-art.csv\")\nresult_df$B_art_p <- B_art$pred\nresult_df$B_art_cp <- B_art$pred_cal\n\nI_gpe <- read.csv(\"./balance_model/pred_result_I-gpe.csv\")\nresult_df$I_gpe_p <- I_gpe$pred\nresult_df$I_gpe_cp <- I_gpe$pred_cal\n\nI_nat <- read.csv(\"./balance_model/pred_result_I-nat.csv\")\nresult_df$I_nat_p <- I_nat$pred\nresult_df$I_nat_cp <- I_nat$pred_cal\n\nI_org <- read.csv(\"./balance_model/pred_result_I-org.csv\")\nresult_df$I_org_p <- I_org$pred\nresult_df$I_org_cp <- I_org$pred_cal\n\nI_art <- read.csv(\"./balance_model/pred_result_I-art.csv\")\nresult_df$I_art_p <- I_art$pred\nresult_df$I_art_cp <- I_art$pred_cal\n\nI_per <- read.csv(\"./balance_model/pred_result_I-per.csv\")\nresult_df$I_per_p <- I_per$pred\nresult_df$I_per_cp <- I_per$pred_cal\n\nI_geo <- read.csv(\"./balance_model/pred_result_I-geo.csv\")\nresult_df$I_geo_p <- I_geo$pred\nresult_df$I_geo_cp <- I_geo$pred_cal\n\nB_nat <- read.csv(\"./balance_model/pred_result_B-nat.csv\")\nresult_df$B_nat_p <- B_nat$pred\nresult_df$B_nat_cp <- B_nat$pred_cal\n\nB_geo <- read.csv(\"./balance_model/pred_result_B-geo.csv\")\nresult_df$B_geo_p <- B_geo$pred\nresult_df$B_geo_cp <- B_geo$pred_cal\n\nB_gpe <- read.csv(\"./balance_model/pred_result_B-gpe.csv\")\nresult_df$B_gpe_p <- B_gpe$pred\nresult_df$B_gpe_cp <- B_gpe$pred_cal\n\nB_eve <- read.csv(\"./balance_model/pred_result_B-eve.csv\")\nresult_df$B_eve_p <- B_eve$pred\nresult_df$B_eve_cp <- B_eve$pred_cal\n\nB_org <- read.csv(\"./balance_model/pred_result_B-org.csv\")\nresult_df$B_org_p <- B_org$pred\nresult_df$B_org_cp <- B_org$pred_cal\n\nB_per <- read.csv(\"./balance_model/pred_result_B-per.csv\")\nresult_df$B_per_p <- B_per$pred\nresult_df$B_per_cp <- B_per$pred_cal\n\nI_tim <- read.csv(\"./balance_model/pred_result_I-tim.csv\")\nresult_df$I_tim_p <- I_tim$pred\nresult_df$I_tim_cp <- I_tim$pred_cal\n\nB_tim <- read.csv(\"./balance_model/pred_result_B-tim.csv\")\nresult_df$B_tim_p <- B_tim$pred\nresult_df$B_tim_cp <- B_tim$pred_cal\n\nI_eve <- read.csv(\"./balance_model/pred_result_I-eve.csv\")\nresult_df$I_eve_p <- I_eve$pred\nresult_df$I_eve_cp <- I_eve$pred_cal\n\n\ndf_bal_result <- as.data.frame(result_df)\ndf_bal_result_p <- df_bal_result[,seq(1,31,2)]\ndf_bal_result_cp <- df_bal_result[,seq(2,32,2)]\n\nbal_test_data <- read.csv(\"./balance_model/df_bal_test.csv\")\n```\n\n## Draw Roc curve\n```{r}\nroc_xgb.data.B_art_p <- extract_evaluation(tagName = \"B-art\",colname = \"B_art_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nroc_xgb.data.I_gpe_p <- extract_evaluation(tagName = \"I-gpe\",colname = \"I_gpe_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nroc_xgb.data.I_nat_p <- extract_evaluation(tagName = \"I-nat\",colname = \"I_nat_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nroc_xgb.data.I_org_p <- extract_evaluation(tagName = \"I-org\",colname = \"I_org_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nroc_xgb.data.I_art_p <- extract_evaluation(tagName = \"I-art\",colname = \"I_art_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nroc_xgb.data.I_per_p <- extract_evaluation(tagName = \"I-per\",colname = \"I_per_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nroc_xgb.data.I_geo_p <- extract_evaluation(tagName = \"I-geo\",colname = \"I_geo_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nroc_xgb.data.B_nat_p <- extract_evaluation(tagName = \"B-nat\",colname = \"B_nat_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nroc_xgb.data.B_geo_p <- extract_evaluation(tagName = \"B-geo\",colname = \"B_geo_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nroc_xgb.data.B_gpe_p <- extract_evaluation(tagName = \"B-gpe\",colname = \"B_gpe_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nroc_xgb.data.B_eve_p <- extract_evaluation(tagName = \"B-eve\",colname = \"B_eve_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nroc_xgb.data.B_org_p <- extract_evaluation(tagName = \"B-org\",colname = \"B_org_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nroc_xgb.data.B_per_p <- extract_evaluation(tagName = \"B-per\",colname = \"B_per_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nroc_xgb.data.I_tim_p <- extract_evaluation(tagName = \"I-tim\",colname = \"I_tim_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nroc_xgb.data.B_tim_p <- extract_evaluation(tagName = \"B-tim\",colname = \"B_tim_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nroc_xgb.data.I_eve_p <- extract_evaluation(tagName = \"I-eve\",colname = \"I_eve_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\ncols <- c(\"b-art\" = \"antiquewhite4\", \"b-eve\" = \"cadetblue4\", \"b-geo\" = \"aquamarine4\", \"b-gpe\" = \"chartreuse3\", \"b-nat\" = \"chocolate3\", \"b-org\" = \"cornflowerblue\", \"b-per\" = \"brown3\", \"b-tim\" = \"darkgoldenrod3\", \"i-art\" = \"darkseagreen3\", \"i-eve\" = \"goldenrod3\", \"i-geo\" = \"gray\", \"i-gpe\" = \"deeppink3\", \"i-nat\" = \"lightsalmon\", \"i-org\" = \"limegreen\", \"i-per\" = \"magenta\", \"i-tim\" = \"navyblue\")\n\n# Creat roc curve for each class\nproc <- ggplot() + \ngeom_line(data = roc_xgb.data.B_art_p, aes(x=fpr, y=tpr,colour = \"b-art\"),lwd = 1) + \ngeom_line(data = roc_xgb.data.B_eve_p, aes(x=fpr, y=tpr,colour = \"b-eve\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.B_geo_p, aes(x=fpr, y=tpr,colour = \"b-geo\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.B_gpe_p, aes(x=fpr, y=tpr,colour = \"b-gpe\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.B_nat_p, aes(x=fpr, y=tpr,colour = \"b-nat\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.B_org_p, aes(x=fpr, y=tpr,colour = \"b-org\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.B_per_p, aes(x=fpr, y=tpr,colour = \"b-per\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.B_tim_p, aes(x=fpr, y=tpr,colour = \"b-tim\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.I_art_p, aes(x=fpr, y=tpr,colour = \"i-art\"),lwd = 1) + \ngeom_line(data = roc_xgb.data.I_eve_p, aes(x=fpr, y=tpr,colour = \"i-eve\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.I_geo_p, aes(x=fpr, y=tpr,colour = \"i-geo\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.I_gpe_p, aes(x=fpr, y=tpr,colour = \"i-gpe\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.I_nat_p, aes(x=fpr, y=tpr,colour = \"i-nat\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.I_org_p, aes(x=fpr, y=tpr,colour = \"i-org\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.I_per_p, aes(x=fpr, y=tpr,colour = \"i-per\"),lwd = 1) +\ngeom_line(data = roc_xgb.data.I_tim_p, aes(x=fpr, y=tpr,colour = \"i-tim\"),lwd = 1) +\ngeom_vline(xintercept = 0.5, color = \"red\", linetype=2) + theme_bw() + #set themes\nscale_colour_manual(name = \"Labels\", values = cols) + \nxlab(\"False Positive Rate\") +\nylab(\"True Positive Rate\") +\ntheme(legend.position = c(0.95, 0.5), \nlegend.text = element_text(size = 15), \nlegend.title = element_text(size = 15),\naxis.title.x = element_text(size = 15),\naxis.title.y = element_text(size = 15))\n\nproc\n```\n\n# Draw Confusion Matrix\n```{r, warning = FALSE}\ndraw_confusion_matrix(tagName = \"B-art\",colname = \"B_art_p\",test_data = bal_test_data, result_data = df_bal_result_p,thresh = 1,color = \"antiquewhite4\")\n\ndraw_confusion_matrix(tagName = \"I-gpe\",colname = \"I_gpe_p\",test_data = bal_test_data, result_data = df_bal_result_p,thresh = 1,color = \"deeppink3\")\n\ndraw_confusion_matrix(tagName = \"I-nat\",colname = \"I_nat_p\",test_data = bal_test_data, result_data = df_bal_result_p,thresh = 1,color = \"lightsalmon\")\n\ndraw_confusion_matrix(tagName = \"I-org\",colname = \"I_org_p\",test_data = bal_test_data, result_data = df_bal_result_p,thresh = 1,color = \"limegreen\")\n\ndraw_confusion_matrix(tagName = \"I-art\",colname = \"I_art_p\",test_data = bal_test_data, result_data = df_bal_result_p,thresh = 1,color = \"darkseagreen3\")\n\ndraw_confusion_matrix(tagName = \"I-per\",colname = \"I_per_p\",test_data = bal_test_data, result_data = df_bal_result_p,thresh = 1,color = \"magenta\")\n\n\ndraw_confusion_matrix(tagName = \"I-geo\",colname = \"I_geo_p\",test_data = bal_test_data, result_data = df_bal_result_p,thresh = 1,color = \"gray\")\n\ndraw_confusion_matrix(tagName = \"B-geo\",colname = \"B_geo_p\",test_data = bal_test_data, result_data = df_bal_result_p,thresh = 1,color = \"aquamarine4\")\n\ndraw_confusion_matrix(tagName = \"B-gpe\",colname = \"B_gpe_p\",test_data = bal_test_data, result_data = df_bal_result_p,thresh = 1,color = \"chartreuse3\")\n\ndraw_confusion_matrix(tagName = \"B-eve\",colname = \"B_eve_p\",test_data = bal_test_data, result_data = df_bal_result_p,thresh = 1,color = \"cadetblue4\")\n\ndraw_confusion_matrix(tagName = \"B-org\",colname = \"B_org_p\",test_data = bal_test_data, result_data = df_bal_result_p,thresh = 1,color = \"cornflowerblue\")\n\ndraw_confusion_matrix(tagName = \"B-per\",colname = \"B_per_p\",test_data = bal_test_data, result_data = df_bal_result_p,thresh = 1,color = \"brown3\")\n\ndraw_confusion_matrix(tagName = \"I-tim\",colname = \"I_tim_p\",test_data = bal_test_data, result_data = df_bal_result_p,thresh = 1,color = \"navyblue\")\n\ndraw_confusion_matrix(tagName = \"B-tim\",colname = \"B_tim_p\",test_data = bal_test_data, result_data = df_bal_result_p,thresh = 0.2,color = \"darkgoldenrod3\")\n\ndraw_confusion_matrix(tagName = \"I-eve\",colname = \"I_eve_p\",test_data = bal_test_data, result_data = df_bal_result_p,thresh = 1,color = \"goldenrod3\")\n\ndraw_confusion_matrix(tagName = \"B-nat\",colname = \"B_nat_p\",test_data = bal_test_data, result_data = df_bal_result_p,thresh = 1,color = \"chocolate3\")\n```\n\n# Draw Precision curve \n```{r}\nprec_xgb.data.B_art_p <- precision_curve(tagName = \"B-art\",colname = \"B_art_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nprec_xgb.data.I_gpe_p <- precision_curve(tagName = \"I-gpe\",colname = \"I_gpe_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nprec_xgb.data.I_nat_p <- precision_curve(tagName = \"I-nat\",colname = \"I_nat_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nprec_xgb.data.I_org_p <- precision_curve(tagName = \"I-org\",colname = \"I_org_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nprec_xgb.data.I_art_p <- precision_curve(tagName = \"I-art\",colname = \"I_art_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nprec_xgb.data.I_per_p <- precision_curve(tagName = \"I-per\",colname = \"I_per_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nprec_xgb.data.I_geo_p <- precision_curve(tagName = \"I-geo\",colname = \"I_geo_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nprec_xgb.data.B_nat_p <- precision_curve(tagName = \"B-nat\",colname = \"B_nat_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nprec_xgb.data.B_geo_p <- precision_curve(tagName = \"B-geo\",colname = \"B_geo_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nprec_xgb.data.B_gpe_p <- precision_curve(tagName = \"B-gpe\",colname = \"B_gpe_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nprec_xgb.data.B_eve_p <- precision_curve(tagName = \"B-eve\",colname = \"B_eve_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nprec_xgb.data.B_org_p <- precision_curve(tagName = \"B-org\",colname = \"B_org_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nprec_xgb.data.B_per_p <- precision_curve(tagName = \"B-per\",colname = \"B_per_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nprec_xgb.data.I_tim_p <- precision_curve(tagName = \"I-tim\",colname = \"I_tim_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nprec_xgb.data.B_tim_p <- precision_curve(tagName = \"B-tim\",colname = \"B_tim_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nprec_xgb.data.I_eve_p <- precision_curve(tagName = \"I-eve\",colname = \"I_eve_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nprec <- ggplot() + \ngeom_line(data = prec_xgb.data.B_art_p, aes(x=x, y=y,colour = \"b-art\"),lwd = 1) + \ngeom_line(data = prec_xgb.data.B_eve_p, aes(x=x, y=y,colour = \"b-eve\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.B_geo_p, aes(x=x, y=y,colour = \"b-geo\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.B_gpe_p, aes(x=x, y=y,colour = \"b-gpe\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.B_nat_p, aes(x=x, y=y,colour = \"b-nat\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.B_org_p, aes(x=x, y=y,colour = \"b-org\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.B_per_p, aes(x=x, y=y,colour = \"b-per\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.B_tim_p, aes(x=x, y=y,colour = \"b-tim\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.I_art_p, aes(x=x, y=y,colour = \"i-art\"),lwd = 1) + \ngeom_line(data = prec_xgb.data.I_eve_p, aes(x=x, y=y,colour = \"i-eve\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.I_geo_p, aes(x=x, y=y,colour = \"i-geo\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.I_gpe_p, aes(x=x, y=y,colour = \"i-gpe\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.I_nat_p, aes(x=x, y=y,colour = \"i-nat\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.I_org_p, aes(x=x, y=y,colour = \"i-org\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.I_per_p, aes(x=x, y=y,colour = \"i-per\"),lwd = 1) +\ngeom_line(data = prec_xgb.data.I_tim_p, aes(x=x, y=y,colour = \"i-tim\"),lwd = 1) +\nxlab(\"Cutoff\") +\nylab(\"Precision\") +\ngeom_vline(xintercept = 0.5, color = \"red\", linetype=2) + theme_bw() +\ntheme(legend.text = element_text(size = 15), \nlegend.title = element_text(size = 15),\naxis.title.x = element_text(size = 15),\naxis.title.y = element_text(size = 15))\n\nprec\n```\n\n## Draw Recall curve\n```{r}\nrec_xgb.data.B_art_p <- recall_curve(tagName = \"B-art\",colname = \"B_art_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nrec_xgb.data.I_gpe_p <- recall_curve(tagName = \"I-gpe\",colname = \"I_gpe_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nrec_xgb.data.I_nat_p <- recall_curve(tagName = \"I-nat\",colname = \"I_nat_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nrec_xgb.data.I_org_p <- recall_curve(tagName = \"I-org\",colname = \"I_org_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nrec_xgb.data.I_art_p <- recall_curve(tagName = \"I-art\",colname = \"I_art_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nrec_xgb.data.I_per_p <- recall_curve(tagName = \"I-per\",colname = \"I_per_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nrec_xgb.data.I_geo_p <- recall_curve(tagName = \"I-geo\",colname = \"I_geo_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nrec_xgb.data.B_nat_p <- recall_curve(tagName = \"B-nat\",colname = \"B_nat_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nrec_xgb.data.B_geo_p <- recall_curve(tagName = \"B-geo\",colname = \"B_geo_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nrec_xgb.data.B_gpe_p <- recall_curve(tagName = \"B-gpe\",colname = \"B_gpe_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nrec_xgb.data.B_eve_p <- recall_curve(tagName = \"B-eve\",colname = \"B_eve_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nrec_xgb.data.B_org_p <- recall_curve(tagName = \"B-org\",colname = \"B_org_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nrec_xgb.data.B_per_p <- recall_curve(tagName = \"B-per\",colname = \"B_per_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nrec_xgb.data.I_tim_p <- recall_curve(tagName = \"I-tim\",colname = \"I_tim_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nrec_xgb.data.B_tim_p <- recall_curve(tagName = \"B-tim\",colname = \"B_tim_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nrec_xgb.data.I_eve_p <- recall_curve(tagName = \"I-eve\",colname = \"I_eve_p\",test_data = bal_test_data, result_data = df_bal_result_p)\n\nrec <- ggplot() + \ngeom_line(data = rec_xgb.data.B_art_p, aes(x=x, y=y,colour = \"b-art\"),lwd = 1) + \ngeom_line(data = rec_xgb.data.B_eve_p, aes(x=x, y=y,colour = \"b-eve\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.B_geo_p, aes(x=x, y=y,colour = \"b-geo\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.B_gpe_p, aes(x=x, y=y,colour = \"b-gpe\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.B_nat_p, aes(x=x, y=y,colour = \"b-nat\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.B_org_p, aes(x=x, y=y,colour = \"b-org\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.B_per_p, aes(x=x, y=y,colour = \"b-per\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.B_tim_p, aes(x=x, y=y,colour = \"b-tim\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.I_art_p, aes(x=x, y=y,colour = \"i-art\"),lwd = 1) + \ngeom_line(data = rec_xgb.data.I_eve_p, aes(x=x, y=y,colour = \"i-eve\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.I_geo_p, aes(x=x, y=y,colour = \"i-geo\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.I_gpe_p, aes(x=x, y=y,colour = \"i-gpe\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.I_nat_p, aes(x=x, y=y,colour = \"i-nat\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.I_org_p, aes(x=x, y=y,colour = \"i-org\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.I_per_p, aes(x=x, y=y,colour = \"i-per\"),lwd = 1) +\ngeom_line(data = rec_xgb.data.I_tim_p, aes(x=x, y=y,colour = \"i-tim\"),lwd = 1) +\nxlab(\"Cutoff\") +\nylab(\"Recall\") +\ngeom_vline(xintercept = 0.5, color = \"red\", linetype=2) + theme_bw() +\ntheme(legend.text = element_text(size = 15), \nlegend.title = element_text(size = 15),\naxis.title.x = element_text(size = 15),\naxis.title.y = element_text(size = 15))\n\nrec\n```\n",
    "created" : 1513297143114.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2596957693",
    "id" : "872F0C5C",
    "lastKnownWriteTime" : 1513490579,
    "last_content_update" : -2147483648,
    "path" : "C:/Users/harryhan/Desktop/SFL_Scientific/interview/r/project.Rmd",
    "project_path" : "project.Rmd",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}